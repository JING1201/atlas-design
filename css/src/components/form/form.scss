/* stylelint-disable max-nesting-depth, selector-no-qualifying-type, selector-max-specificity  */

$form-font-size: $font-size-7;
$form-font-size-sm: $font-size-8;
$form-font-size-lg: $font-size-6;

$icon-font-size: $font-size-7;
$icon-font-size-sm: $font-size-8;
$icon-lg-font-size: $font-size-6;
$icon-size: 2.25em;
$icon-size-lg: 2.25em;

$icon-color: $secondary-background !default;
$icon-active-color: $secondary !default;

.control {
	position: relative;
	font-size: $form-font-size;
	text-align: left;

	&.control-icons {
		.icon {
			position: absolute;
			inset-block-start: 0;
			inset-inline-start: 0;
			width: $icon-size;
			height: $icon-size;
			color: $icon-color;
			font-size: $icon-font-size;
			pointer-events: none;
			z-index: $zindex-multi;
			padding-inline-start: $icon-size;
		}

		.input,
		.select select {
			padding-inline-start: $icon-size;
		}

		.input,
		.select {
			~ .icon {
				font-size: $icon-font-size;
			}

			&.focus-visible {
				~ .icon,
				.icon {
					color: $icon-active-color;
				}
			}

			&.input-sm,
			&.select-sm {
				~ .icon,
				.icon {
					font-size: $icon-font-size-sm;
				}
			}

			&.input-lg,
			&.select-lg {
				~ .icon,
				.icon {
					font-size: $icon-lg-font-size;
				}
			}
		}

		&.control-icon-right {
			.input {
				padding-inline: $control-padding-horizontal;

				~ .icon {
					inset-inline-start: unset;
					inset-inline-end: 0;
				}
			}

			.select {
				~ .icon {
					inset-inline-start: unset;
					inset-inline-end: 2.25em;
				}
			}

			.input,
			.select select {
				padding-inline-end: $icon-size;
			}

			.input[type='date'] {
				position: relative;

				&::-webkit-calendar-picker-indicator {
					position: absolute;
					width: 1.5em;
					background: none;
					color: transparent;
					#{$user-right}: 0;
					z-index: $zindex-dropdown;
				}
			}
		}
	}

	&.is-loading {
		&::after {
			@include loader;

			position: absolute !important;
			inset-inline-end: 0.625em;
			top: 0.625em;
			z-index: $zindex-multi;
		}

		&.control-small::after {
			font-size: $form-font-size-sm;
		}

		&.control-medium::after {
			font-size: $form-font-size;
		}

		&.control-large::after {
			font-size: $form-font-size-lg;
		}
	}
}

.field {
	&:not(:last-child) {
		margin-block-end: 0.75rem;
	}

	// Modifiers

	&.field-addons {
		display: flex;
		justify-content: flex-start;

		.control {
			&:not(:last-child) {
				margin-inline-end: -1px;
			}

			&:first-child {
				.button,
				.input,
				.select select {
					border-top-right-radius: 0;
					border-bottom-right-radius: 0;
				}
			}

			&:last-child {
				.button,
				.input,
				.select select {
					border-top-left-radius: 0;
					border-bottom-left-radius: 0;
				}
			}

			&:not(:first-child):not(:last-child) {
				.button,
				.input,
				.select select {
					border-radius: 0;
				}
			}
		}
	}

	.field-label {
		margin-block-end: 0.5rem;

		.label {
			font-size: inherit;
		}

		@include tablet {
			flex: 1 0 0;
			margin-inline-end: 1.5rem;
			margin-block-end: 0;

			&.field-label-sm {
				font-size: $form-font-size-sm;
			}

			&.field-label-lg {
				font-size: $form-font-size-lg;
			}
		}
	}

	&.field-horizontal {
		@include tablet {
			display: flex;
		}

		.field-label {
			@include tablet {
				align-self: center;
				text-align: right;
			}
		}

		.field-body {
			.field .field {
				margin-block-end: 0;
			}

			@include tablet {
				display: flex;
				flex: 5 1 0;

				.field {
					margin-block-end: 0;
				}

				> .field {
					flex-shrink: 1;

					&:not(.is-narrow) {
						flex-grow: 1;
					}

					&:not(:last-child) {
						margin-inline-end: 0.75rem;
					}
				}
			}

			&.extend-input-field {
				flex-basis: auto;
			}
		}
	}
}

.required-indicator::after,
::part(required-indicator)::after {
	color: $danger;
	content: '*';
	vertical-align: baseline;
}
